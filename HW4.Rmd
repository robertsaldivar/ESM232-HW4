---
title: "HW 4"
author: "Robert Saldivar and Madeline Gorchels"
date: "5/4/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Loading neccessary packages

library(tidyverse)
library(deSolve)
library(sensitivity)

```

##Part 2: Run Model for 300 Years
```{r}
source("forest_growth.R")

initialforest = 100
#The function runs on it's own:
#forest_growth(initialC=initialforest, r=0.01, g=2, carry_capacity=500, air_temp=20, canopy_closure=100)

years = seq(from=1, to=300, by=1)
parms_1= list(initialC=initialforest, r=0.01, g=2, c_closure=100, carry_capacity=500, air_temp=20)

forest_1 = ode(y=initialforest, times=years, func=forest_growth,parms=parms_1)

#colnames(forest_1,c("year","C"))
#forest_1
d_forest_1 = as.data.frame(forest_1) %>% 
  mutate(biomass=d_forest_1$`1`)


C_plot_1 = ggplot(d_forest_1)+
  geom_point(aes(x=time, y=biomass))+
  labs(y="Tree Biomass (kg C)", x="Years")+
  theme_classic()

C_plot_1
         
```

